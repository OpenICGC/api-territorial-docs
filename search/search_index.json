{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"API Territorial","text":"<p>versi\u00f3 1.0.0</p>"},{"location":"#que-es","title":"Qu\u00e8 \u00e9s?","text":"<p>Benvinguts a l'API Territorial de l'ICGC, una Interf\u00edcie de Programaci\u00f3 d'Aplicacions (Application Programming Interface) que consisteix en una eina que integra diverses fonts de dades geogr\u00e0fiques per proporcionar-te informaci\u00f3 precisa i detallada del territori a partir d'unes coordenades geogr\u00e0fiques o UTM.</p> <p></p>"},{"location":"#com-funciona","title":"Com funciona?","text":"<p>Es tracta d'una API REST que funciona a partir d'un protocol HTTPS. Es basa tot en un motor de cerca que gestiona les peticions (segons el format) i realitza la connexi\u00f3 amb la base de dades o la consulta corresponent al servei WMS/WFS/WCS, i dona com a resposta una col\u00b7lecci\u00f3 en format GeoJSON.</p> <p></p> <p>Envia un parell de coordenades del territori de Catalunya i la nostra API et retornar\u00e0 un GeoJSON amb els serveis que intersecten amb aquestes ubicacions. Les peticions es poden personalitzar amb el par\u00e0metre 'servei', permetent-te seleccionar-los tots (all), o seleccionar serveis espec\u00edfics pel seu nom (separats per coma). </p>"},{"location":"#casos-dus","title":"Casos d'\u00fas","text":"<p>- Explora el territori a la teva manera: descobreix dades detallades sobre municipis, comarques o altres serveis, i visualitza-les en un mapa interactiu.</p> <p>- Compr\u00e8n el paisatge amb detall: analitza la distribuci\u00f3 de la vegetaci\u00f3, la topografia i d'altres caracter\u00edstiques geogr\u00e0fiques en una \u00e0rea espec\u00edfica.</p> <p>- Planifica el futur de les zones urbanes: accedeix a dades sobre usos del s\u00f2l, vegueries i d'altres serveis per a una planificaci\u00f3 urbana informada.</p> <p>- Gesti\u00f3 forestal: visualitza dades sobre incendis i vegetaci\u00f3 a Catalunya per a una correcta planificaci\u00f3 i gesti\u00f3 forestal.</p> <p>- Gesti\u00f3 de recursos h\u00eddrics: planifica i monitora els recursos h\u00eddrics amb dades essencials sobre aq\u00fc\u00edfers i conques hidrogr\u00e0fiques.</p> <p>- Navegaci\u00f3 intu\u00eftiva pel teu entorn: utilitza la informaci\u00f3 detallada del Sistema d'Orientaci\u00f3 Cartogr\u00e0fica per explorar i orientar-te amb facilitat.</p> <p>- An\u00e0lisi de salut p\u00fablica: utilitza les \"\u00c0rees B\u00e0siques de Salut\" i les \"Regions Sanit\u00e0ries\" per aprofundir en an\u00e0lisis epidemiol\u00f2giques i planificaci\u00f3 de serveis de salut.</p> <p>- Planificaci\u00f3 del territori per a serveis socials: empra les \"\u00c0rees B\u00e0siques de Serveis Socials\" per analitzar la distribuci\u00f3 de serveis socials i identificar \u00e0rees amb necessitats creixents.</p> <p>- Seguretat p\u00fablica i policial: utilitza les \"\u00c0rees B\u00e0siques Policials\" per a la planificaci\u00f3 de recursos policials i la identificaci\u00f3 de zones amb necessitats especials de seguretat.</p> <p>- Gesti\u00f3 hidrol\u00f2gica detallada: explora les \"Subconques hidrol\u00f2giques\" per a una gesti\u00f3 m\u00e9s precisa dels recursos h\u00eddrics a nivell local.</p> <p>- An\u00e0lisi de dades cadastrals: utilitza les \"Parcel\u00b7les cadastrals\" per a l'an\u00e0lisi detallada de la propietat del s\u00f2l i la planificaci\u00f3 del desenvolupament urb\u00e0.</p> <p></p>"},{"location":"#exemples","title":"Exemples","text":"<p>A la secci\u00f3 API-Examples proporcionem demostracions pr\u00e0ctiques per ajudar-te a connectar-te a l'API i fer peticions. Aix\u00f2 facilita la implementaci\u00f3 r\u00e0pida i eficient als teus projectes.</p> <ul> <li>Exemples</li> </ul> <p></p>"},{"location":"#documentacio","title":"Documentaci\u00f3","text":"<p>Explora la secci\u00f3 API-Docs per veure i testejar tots els serveis i m\u00e8todes disponibles. Amb una interf\u00edcie intu\u00eftiva, podr\u00e0s comprendre f\u00e0cilment com utilitzar cada servei i personalitzar les teves peticions.</p> <ul> <li>API Docs</li> </ul> <p></p>"},{"location":"#visualitzacio-en-temps-real","title":"Visualitzaci\u00f3 en temps real","text":"<p>A la secci\u00f3 API-Viewer pots veure el funcionament de l'API en temps real. Selecciona qualsevol servei en un desplegable i visualitza'l f\u00e0cilment fent clic sobre el mapa interactiu.</p> <ul> <li>Visor - API Viewer </li> </ul>"},{"location":"#llicencia","title":"Llic\u00e8ncia","text":"<p>Dades de l'ICGC: Llic\u00e8ncia de Reconeixement 4.0 Internacional de Creative Commons. M\u00e9s informaci\u00f3 Dades d'altres administracions: Enlla\u00e7</p>"},{"location":"#versionat","title":"Versionat","text":"<p>Versi\u00f3 1.0.0</p>"},{"location":"#_1","title":"Inici","text":""},{"location":"#autor-i-contacte","title":"Autor i Contacte","text":"<p>Unitat Geostart, Institut Cartogr\u00e0fic i Geol\u00f2gic de Catalunya. </p>"},{"location":"3.1.0.Map/","title":"Visor","text":""},{"location":"Connexio/","title":"Connexi\u00f3 a l'API","text":""},{"location":"Connexio/#javascript","title":"JavaScript","text":""},{"location":"Connexio/#via-fetch","title":"Via Fetch","text":"<pre><code>let servei = \"vegueries\"; //canvia'l pel que vulguis\n\n//Connexi\u00f3 amb l'API\nasync function apiConnect() {\n  const response = await fetch(\n    `https://api.icgc.cat/territori/${servei}/geo/${lat}/${lon}`\n  );\n  dades = await response.json();\n}\n</code></pre>"},{"location":"Connexio/#via-axios","title":"Via Axios","text":"<pre><code>&lt;script src=\"https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js\"&gt;&lt;/script&gt;\n</code></pre> <pre><code>let serveis = \"municipis, provincies, comarques\"; //afegeix els que vulguis\n\n//Connexi\u00f3 amb l'API\nasync function apiConnect() {\n  const response = await axios.get(\n    `https://api.icgc.cat/territori/${serveis}/utm/${x}/${y}`\n  );\n  const dades = response.data;\n}\n</code></pre>"},{"location":"Connexio/#node","title":"Node","text":"<p>Cal tenir Node.js instal\u00b7lat</p> <p>Instal\u00b7lar axios</p> <pre><code>npm install axios\n</code></pre> <p>Petici\u00f3:</p> <pre><code>const axios = require(\"axios\");\nlet servei = 'all'; //tots els serveis\n\n//Connexi\u00f3 amb l'API\nasync function apiConnect() {\n  try {\n    const response = await axios.get(\n      `https://api.icgc.cat/territori/${servei}/geo/${lat}/${lon}`\n    );\n    const dades = response.data;\n  }\n}\n</code></pre>"},{"location":"Connexio/#python","title":"Python","text":"<pre><code>import requests\n\nservei = \"vegueries\"  # canvia'l pel que vulguis\nlat = 41.38879  # substitueix amb la latitud desitjada\nlon = 2.15899  # substitueix amb la longitud desitjada\n\n# Connexi\u00f3 amb l'API\ndef api_connect():\n    url = f\"https://api.icgc.cat/territori/{servei}/geo/{lat}/{lon}\"\n    response = requests.get(url)\n    dades = response.json()\n    return dades\n\ndades = api_connect()\nprint(dades)  # mostra les dades obtingudes de l'API\n</code></pre>"},{"location":"Connexio/#java","title":"JAVA","text":"<pre><code>import java.io.IOException;\nimport java.net.HttpURLConnection;\nimport java.net.URL;\nimport java.util.Scanner;\n\npublic class Main {\n    public static void main(String[] args) {\n        String servei = \"vegueries\"; // canvia'l pel que vulguis\n        double lat = 41.38879; // substitueix amb la latitud desitjada\n        double lon = 2.15899; // substitueix amb la longitud desitjada\n\n        try {\n            String urlStr = \"https://api.icgc.cat/territori/\" + servei + \"/geo/\" + lat + \"/\" + lon;\n            URL url = new URL(urlStr);\n            HttpURLConnection conn = (HttpURLConnection) url.openConnection();\n            conn.setRequestMethod(\"GET\");\n            conn.connect();\n\n            // Llegir la resposta de l'API\n            Scanner scanner = new Scanner(url.openStream());\n            StringBuilder response = new StringBuilder();\n            while (scanner.hasNext()) {\n                response.append(scanner.nextLine());\n            }\n            scanner.close();\n\n            System.out.println(response.toString()); // mostra les dades obtingudes de l'API\n\n        } catch (IOException e) {\n            e.printStackTrace();\n        }\n    }\n}\n</code></pre>"},{"location":"Connexio/#php","title":"PHP","text":"<pre><code>&lt;?php\n$servei = \"vegueries\"; // canvia'l pel que vulguis\n$lat = 41.38879; // substitueix amb la latitud desitjada\n$lon = 2.15899; // substitueix amb la longitud desitjada\n\n$url = \"https://api.icgc.cat/territori/$servei/geo/$lat/$lon\";\n\n// Realitza la petici\u00f3 a l'API\n$response = file_get_contents($url);\n\n// Decodifica la resposta JSON\n$dades = json_decode($response);\n\n// Mostra les dades obtingudes de l'API\nprint_r($dades);\n?&gt;\n</code></pre>"},{"location":"Connexio/#r","title":"R","text":"<pre><code>library(httr)\n\nservei &lt;- \"vegueries\"  # canvia per al servei que desitgis\nlat &lt;- 41.38879  # substitueix per la latitud desitjada\nlon &lt;- 2.15899  # substitueix per la longitud desitjada\n\nurl &lt;- sprintf(\"https://api.icgc.cat/territori/%s/geo/%f/%f\", servei, lat, lon)\n\n# Realitza la petici\u00f3 GET a l'API\nresposta &lt;- GET(url)\n\n# Extreu les dades de la resposta\ndades &lt;- content(resposta, \"parsed\")\n\n# Mostra les dades obtingudes de l'API\nprint(dades)\n</code></pre>"},{"location":"Leaflet/","title":"Carregar i visualitzar servei a un mapa Leaflet","text":"<p> See the Pen    Exemple AddMarker by unitatgeostart (@unitatgeostart)   on CodePen. </p> <p>CodePen</p> <pre><code>&lt;html&gt;\n  &lt;head&gt;\n    &lt;meta charset=\"utf-8\" /&gt;\n    &lt;title&gt;Connexi\u00f3 a l'API&lt;/title&gt;\n    &lt;meta\n      name=\"viewport\"\n      content=\"initial-scale=1,maximum-scale=1,user-scalable=no\"\n    /&gt;\n    &lt;link rel=\"stylesheet\" href=\"https://unpkg.com/leaflet/dist/leaflet.css\" /&gt;\n    &lt;script src=\"https://unpkg.com/leaflet/dist/leaflet.js\"&gt;&lt;/script&gt;\n\n    &lt;style&gt;\n      #info {\n        background-color: white;\n        font-family: Arial;\n        text-align: center;\n        padding: 5px;\n        font-weight: 500;\n        font-size: 0.9em;\n      }\n    &lt;/style&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;div id=\"info\"&gt;Fes clic sobre el mapa.&lt;/div&gt;\n    &lt;div id=\"map\"&gt;&lt;/div&gt;\n    &lt;script&gt;\n      let service = \"municipis\";\n      let puntLayer;\n      let dades;\n\n      //Connexi\u00f3 amb l'API i afegir al mapa la resposta geojson\n      async function apiConnect(lat, lon) {\n        const response = await fetch(\n          `https://api.icgc.cat/territori/${service}/geo/${lon}/${lat}`\n        );\n        dades = await response.json();\n\n        //si volem veure la resposta completa a la consola:\n        // console.log(\"dades\", dades);\n\n        if (puntLayer) {\n          map.removeLayer(puntLayer);\n        }\n\n        puntLayer = L.geoJSON(dades[0].features, {\n          style: {\n            fillColor: \"yellow\",\n            fillOpacity: 0.8,\n          },\n        }).addTo(map);\n\n        if (dades[0].features) {\n          document.getElementById(\"info\").innerHTML =\n            \"Municipi: \" + dades[0].features[0].properties.NOMMUNI;\n        } else {\n          document.getElementById(\"info\").innerHTML =\n            \"No hi ha dades pel punt seleccionat\";\n        }\n      }\n\n      // Crear el mapa\n      var map = L.map(\"map\").setView([41.387, 2.169], 9);\n      var marker1;\n      L.tileLayer(\n        \"https://geoserveis.icgc.cat/servei/catalunya/contextmaps/wmts/contextmaps-mapa-estandard/MON3857NW/{z}/{x}/{y}.png\"\n      ).addTo(map);\n\n      //Obtenim les coordenades i cridem la funci\u00f3 apiConnect()\n      //tamb\u00e9 afegim un marcador al punt clicat\n      map.on(\"click\", function (e) {\n        let lon = e.latlng.lng;\n        let lat = e.latlng.lat;\n        apiConnect(lat, lon);\n\n        if (!marker1) {\n          marker1 = L.marker([lat, lon]).addTo(map);\n        } else {\n          map.removeLayer(marker1);\n          marker1 = L.marker([lat, lon]).addTo(map);\n        }\n      });\n    &lt;/script&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"Maplibre/","title":"Carregar i visualitzar servei a un mapa Maplibre","text":"<p> See the Pen    Exemple AddMarker by unitatgeostart (@unitatgeostart)   on CodePen. </p> <p>CodePen</p> <pre><code>&lt;html&gt;\n  &lt;head&gt;\n    &lt;meta charset=\"utf-8\" /&gt;\n    &lt;title&gt;Connexi\u00f3 a l'API&lt;/title&gt;\n    &lt;meta\n      name=\"viewport\"\n      content=\"initial-scale=1,maximum-scale=1,user-scalable=no\"\n    /&gt;\n    &lt;link\n      rel=\"stylesheet\"\n      href=\"https://unpkg.com/maplibre-gl@2.0.1/dist/maplibre-gl.css\"\n    /&gt;\n    &lt;script src=\"https://unpkg.com/maplibre-gl@2.0.1/dist/maplibre-gl.js\"&gt;&lt;/script&gt;\n\n    &lt;style&gt;\n      #info {\n        background-color: white;\n        font-family: Arial;\n        text-align: center;\n        padding: 5px;\n        font-weight: 500;\n        font-size: 0.9em;\n      }\n    &lt;/style&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;div id=\"info\"&gt;Fes clic sobre el mapa.&lt;/div&gt;\n    &lt;div id=\"map\"&gt;&lt;/div&gt;\n    &lt;script&gt;\n      var marker1;\n      var map = new maplibregl.Map({\n        container: \"map\",\n        style:\n          \"https://geoserveis.icgc.cat/contextmaps/icgc_mapa_base_fosc.json\", //(orto) \"https://geoserveis.icgc.cat/contextmaps/icgc_orto_estandard.json\",\n        center: [2.0042, 41.4747],\n        zoom: 8,\n        attributionControl: false,\n        hash: false,\n      });\n      map.addControl(new maplibregl.NavigationControl());\n\n      map.on(\"click\", function (e) {\n        let lon = e.lngLat.lng;\n        let lat = e.lngLat.lat;\n        apiConnect(lat, lon, \"municipis\");\n        if (!marker1) {\n          marker1 = new maplibregl.Marker({ color: \"#FF6E42\" })\n            .setLngLat([lon, lat])\n            .addTo(map);\n        } else {\n          marker1.remove();\n          marker1 = new maplibregl.Marker({ color: \"#FF6E42\" })\n            .setLngLat([lon, lat])\n            .addTo(map);\n        }\n      });\n\n      async function apiConnect(lat, lon, service) {\n        const response = await fetch(\n          `https://api.icgc.cat/territori/${service}/geo/${lon}/${lat}`\n        );\n        const dades = await response.json();\n        console.log(\"dades\", dades);\n        document.getElementById(\"info\").innerHTML =\n          \"Municipi: \" + dades[0].features[0].properties.NOMMUNI;\n\n        if (!map.getLayer(\"punts\")) {\n          map.addSource(\"punts\", {\n            type: \"geojson\",\n            data: {\n              type: \"FeatureCollection\",\n              features: dades[0].features,\n            },\n          });\n          map.addLayer({\n            id: \"punts\",\n            type: \"fill\",\n            source: \"punts\",\n            paint: {\n              \"fill-color\": \"#f0f0f0\",\n              \"fill-opacity\": 0.6,\n            },\n          });\n        } else {\n          map.removeLayer(\"punts\").removeSource(\"punts\");\n          map.addSource(\"punts\", {\n            type: \"geojson\",\n            data: {\n              type: \"FeatureCollection\",\n              features: dades[0].features,\n            },\n          });\n          map.addLayer({\n            id: \"punts\",\n            type: \"fill\",\n            source: \"punts\",\n            paint: {\n              \"fill-color\": \"#ffffff\",\n              \"fill-opacity\": 0.75,\n            },\n          });\n        }\n      }\n    &lt;/script&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"Peticio/","title":"Petici\u00f3 i format de resposta","text":""},{"location":"Peticio/#peticions","title":"Peticions","text":"<p>Exemple petici\u00f3 ID servei '''municipis''' amb lon/lat</p> <pre><code>https://api.icgc.cat/territori/municipis/geo/2.746/41.914\n</code></pre> <p>Exemple petici\u00f3 ID servei '''municipis''' amb UTM 31N X/Y</p> <pre><code>https://api.icgc.cat/territori/municipis/utm/432648.873/4624697.432\n</code></pre> <p>Exemple petici\u00f3 varis ID de serveis, concatenats amb , i lon/lat <pre><code>https://api.icgc.cat/territori/municipis,comarques,provincies,vegueries/geo/2.746/41.914\n</code></pre> <p>Exemple petici\u00f3 tots els serveis amb lon/lat</p> <pre><code>https://api.icgc.cat/territori/all/geo/2.746/41.914\n</code></pre>"},{"location":"Peticio/#resposta-en-format-geojson","title":"Resposta en format GeoJson","text":"<pre><code>[{\"type\":\"FeatureCollection\",\n\"features\":[{\"type\":\"Feature\",\"geometry\":{\"type\":\"MultiPolygon\",\n\"coordinates\":[[[[2.74737,41.92599],..... ,[2.74737,41.92599]]]]},\n\"properties\":{\"CODIMUNI\":\"172333\",....,\"CAPPROV\":\"Girona\"},\n\"id\":\"Municipis\"}]},\"NumResponses:1\"]\n</code></pre> <p>Veure visor playground</p>"},{"location":"Peticio/#serveis-disponibles","title":"Serveis disponibles","text":"Servei Organisme ID Agrupacions censals Institut d'Estad\u00edstica de Catalunya agrupacionscensals \u00c0rees B\u00e0siques de Salut Departament de Salut areesbasiquessalut \u00c0rees B\u00e0siques de Serveis Socials Departament de Drets Socials areasbasiquesservicisocials \u00c0rees B\u00e0siques Policials Departament Interior areasbasiquespolicials \u00c0rees hidrogeol\u00f2giques naturalesa aq\u00fc\u00edfers Institut Cartogr\u00e0fic i Geol\u00f2gic de Catalunya aquifers Cobertes del s\u00f2l Institut Cartogr\u00e0fic i Geol\u00f2gic de Catalunya cobertessol Comarques Institut Cartogr\u00e0fic i Geol\u00f2gic de Catalunya comarques Conques hidrol\u00f2giques principals Ag\u00e8ncia Catalana de l'Aigua conqueshidrologiques Fulls ETRS 89 1:5 000 Institut Cartogr\u00e0fic i Geol\u00f2gic de Catalunya tall5me Elevacions Institut Cartogr\u00e0fic i Geol\u00f2gic de Catalunya elevacions Geocodificador ICGC Institut Cartogr\u00e0fic i Geol\u00f2gic de Catalunya geocoder Hex-based grid system Uber h3 Incendis forestals 1986-2022 Departament d'Acci\u00f3 Clim\u00e0tica, Alimentaci\u00f3 i Agenda Rural incendis Mapa urb\u00e0 Classificacions Departament de Territori mucclassificacions Mapa urb\u00e0 Qualificacions Departament de Territori mucqualificacions Municipis Institut Cartogr\u00e0fic i Geol\u00f2gic de Catalunya municipis PEIN Departament de Medi Ambient i Sostenibilitat pein Parcel\u00b7les cadastrals Direcci\u00f3n General del Catastro cadastre Provincies Institut Cartogr\u00e0fic i Geol\u00f2gic de Catalunya provincies Regions sanit\u00e0ries Departament de Salut regionssanitaries Seccions censals Institut Cartogr\u00e0fic i Geol\u00f2gic de Catalunya seccionscensals SIGPAC Recintes Departament d'Acci\u00f3 Clim\u00e0tica, Alimentaci\u00f3 i Agenda Rural recintessigpac Sistema d'orientacio cartogr\u00e0fica Departament d'Interior sistemaorientaciocartografica Subconques hidrol\u00f2giques Ag\u00e8ncia Catalana de l'Aigua subconqueshidrologiques Unitats geol\u00f2giques 50 m Institut Cartogr\u00e0fic i Geol\u00f2gic de Catalunya unitatsgeologiques Vegetaci\u00f3 H\u00e0bitats Catalunya Departament d'Acci\u00f3 Clim\u00e0tica, Alimentaci\u00f3 i Agenda Rural vegetacio Vegueries Institut Cartogr\u00e0fic i Geol\u00f2gic de Catalunya vegueries"},{"location":"Playground/","title":"Playground","text":"Visor API Territorial Clica sobre un punt del mapa Servei seleccionat: Municipis Comarques Provincies Vegueries Seccions Censals Elevacions Agrupacions Censals Regions Sanit\u00e0ries \u00c0rees B\u00e0siques Policials \u00c0rees B\u00e0siques Serveis Socials Cobertes del s\u00f2l Mapa Urb\u00e0 de Qualificacions H3 Grid System PEIN Recintes SIGPAC Geocodificador invers Conques Hidrol\u00f2giques            Subconques Hidrol\u00f2giques                     Sistema d'Orientaci\u00f3 Cartogr\u00e0fica          Tall 5m E Aq\u00fc\u00edfers Unitats geol\u00f2giques Vegetacio H\u00e0bitats Catalunya Incendis Forestals Cadastre <pre>Resposta Geojson</pre>  download   content_copy"},{"location":"Propietats/","title":"Visualitzar propietats d'un servei","text":"<p> See the Pen    Exemple AddMarker by unitatgeostart (@unitatgeostart)   on CodePen. </p> <p>CodePen</p> <pre><code>&lt;html&gt;\n  &lt;head&gt;\n    &lt;meta charset=\"utf-8\" /&gt;\n    &lt;title&gt;API Territorial - Propietats&lt;/title&gt;\n    &lt;meta\n      name=\"viewport\"\n      content=\"initial-scale=1,maximum-scale=1,user-scalable=no\"\n    /&gt;\n\n    &lt;style&gt;\n      #info {\n        background-color: white;\n        font-family: Arial;\n        text-align: center;\n        padding: 5px;\n        font-weight: 500;\n        font-size: 0.9em;\n      }\n    &lt;/style&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;pre id=\"info\"&gt;Carregant dades...&lt;/pre&gt;\n\n    &lt;script&gt;\n      let dades;\n      let servei = \"municipis\"; //canvia'l pel que vulguis\n      let lon = 2.01;\n      let lat = 41.5;\n      //Connexi\u00f3 amb l'API\n      async function apiConnect() {\n        const response = await fetch(\n          `https://api.icgc.cat/territori/${servei}/geo/${lon}/${lat}`\n        );\n        dades = await response.json();\n        if (dades) {\n          document.getElementById(\"info\").innerHTML = JSON.stringify(\n            dades[0].features[0].properties,\n            null,\n            2\n          );\n        } else {\n          document.getElementById(\"info\").innerHTML =\n            \"La petici\u00f3 no ha obtingut resposta\";\n        }\n      }\n      apiConnect();\n    &lt;/script&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"apidocs/","title":"Documentaci\u00f3","text":""},{"location":"mapbox/","title":"Carregar i visualitzar servei a un mapa Mapbox","text":"<p> See the Pen    Exemple AddMarker by unitatgeostart (@unitatgeostart)   on CodePen. </p> <p>CodePen</p> <pre><code>&lt;html&gt;\n  &lt;head&gt;\n    &lt;meta charset=\"utf-8\" /&gt;\n    &lt;title&gt;Connexi\u00f3 a l'API&lt;/title&gt;\n    &lt;meta\n      name=\"viewport\"\n      content=\"initial-scale=1,maximum-scale=1,user-scalable=no\"\n    /&gt;\n    &lt;script src=\"https://api.mapbox.com/mapbox-gl-js/v1.13.0/mapbox-gl.js\"&gt;&lt;/script&gt;\n    &lt;link\n      href=\"https://api.mapbox.com/mapbox-gl-js/v1.13.0/mapbox-gl.css\"\n      rel=\"stylesheet\"\n    /&gt;\n\n    &lt;style&gt;\n      #info {\n        background-color: white;\n        font-family: Arial;\n        text-align: center;\n        padding: 5px;\n        font-weight: 500;\n        font-size: 0.9em;\n      }\n    &lt;/style&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;div id=\"info\"&gt;Fes clic sobre el mapa.&lt;/div&gt;\n    &lt;div id=\"map\"&gt;&lt;/div&gt;\n    &lt;script&gt;\n      var marker1;\n      var map = new mapboxgl.Map({\n        container: \"map\",\n        style:\n          \"https://geoserveis.icgc.cat/contextmaps/icgc_mapa_base_fosc.json\", //(orto) \"https://geoserveis.icgc.cat/contextmaps/icgc_orto_estandard.json\",\n        center: [2.0042, 41.4747],\n        zoom: 8,\n        attributionControl: false,\n        hash: false,\n      });\n      map.addControl(new mapboxgl.NavigationControl());\n\n      map.on(\"click\", function (e) {\n        let lon = e.lngLat.lng;\n        let lat = e.lngLat.lat;\n        apiConnect(lat, lon, \"municipis\");\n        if (!marker1) {\n          marker1 = new mapboxgl.Marker({ color: \"#FF6E42\" })\n            .setLngLat([lon, lat])\n            .addTo(map);\n        } else {\n          marker1.remove();\n          marker1 = new mapboxgl.Marker({ color: \"#FF6E42\" })\n            .setLngLat([lon, lat])\n            .addTo(map);\n        }\n      });\n\n      async function apiConnect(lat, lon, service) {\n        const response = await fetch(\n          `https://api.icgc.cat/territori/${service}/geo/${lon}/${lat}`\n        );\n        const dades = await response.json();\n        console.log(\"dades\", dades);\n        document.getElementById(\"info\").innerHTML =\n          \"Municipi: \" + dades[0].features[0].properties.NOMMUNI;\n\n        if (!map.getLayer(\"punts\")) {\n          map.addSource(\"punts\", {\n            type: \"geojson\",\n            data: {\n              type: \"FeatureCollection\",\n              features: dades[0].features,\n            },\n          });\n          map.addLayer({\n            id: \"punts\",\n            type: \"fill\",\n            source: \"punts\",\n            paint: {\n              \"fill-color\": \"#f0f0f0\",\n              \"fill-opacity\": 0.6,\n            },\n          });\n        } else {\n          map.removeLayer(\"punts\").removeSource(\"punts\");\n          map.addSource(\"punts\", {\n            type: \"geojson\",\n            data: {\n              type: \"FeatureCollection\",\n              features: dades[0].features,\n            },\n          });\n          map.addLayer({\n            id: \"punts\",\n            type: \"fill\",\n            source: \"punts\",\n            paint: {\n              \"fill-color\": \"#ffffff\",\n              \"fill-opacity\": 0.75,\n            },\n          });\n        }\n      }\n    &lt;/script&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"mapicgc/","title":"Carregar i visualitzar servei a un mapa MapICGC","text":"<p> See the Pen    Exemple AddMarker by unitatgeostart (@unitatgeostart)   on CodePen. </p> <p>CodePen</p> <pre><code>&lt;html&gt;\n  &lt;head&gt;\n    &lt;meta charset=\"utf-8\" /&gt;\n    &lt;title&gt;Connexi\u00f3 a l'API&lt;/title&gt;\n    &lt;meta\n      name=\"viewport\"\n      content=\"initial-scale=1,maximum-scale=1,user-scalable=no\"\n    /&gt;\n    &lt;script src=\"https://tilemaps.icgc.cat/cdn/mapicgc-gl-js/mapicgc-gl.js\"&gt;&lt;/script&gt;\n    &lt;link\n      href=\"https://tilemaps.icgc.cat/cdn/mapicgc-gl-js/mapicgc-gl.css\"\n      rel=\"stylesheet\"\n    /&gt;\n\n    &lt;style&gt;\n      #info {\n        background-color: white;\n        font-family: Arial;\n        text-align: center;\n        padding: 5px;\n        font-weight: 500;\n        font-size: 0.9em;\n      }\n    &lt;/style&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;div id=\"map\" style=\"height:375px;\"&gt;&lt;/div&gt;\n    &lt;div id=\"info\"&gt;Fes clic sobre el mapa.&lt;/div&gt;\n    &lt;script&gt;\n      var marker1;\n      let geojsonLayer;\n      const map = new mapicgcgl.Map({\n        container: \"map\",\n        style: mapicgcgl.Styles.TOPO,\n        center: [2.1464, 41.306],\n        zoom: 7.4,\n        maxZoom: 14,\n        hash: true,\n        pitch: 0,\n      });\n\n      map.on(\"click\", function (e) {\n        let lon = e.lngLat.lng;\n        let lat = e.lngLat.lat;\n        apiConnect(lat, lon, \"municipis\");\n        if (!marker1) {\n          marker1 = map.addMarker({ color: \"#FF6E42\", coord: [lon, lat] });\n        } else {\n          marker1.remove();\n          marker1 = map.addMarker({ color: \"#FF6E42\", coord: [lon, lat] });\n        }\n      });\n\n      async function apiConnect(lat, lon, service) {\n        const response = await fetch(\n          `https://api.icgc.cat/territori/${service}/geo/${lon}/${lat}`\n        );\n        const dades = await response.json();\n        console.log(\"dades\", dades);\n        document.getElementById(\"info\").innerHTML =\n          \"Municipi: \" + dades[0].features[0].properties.NOMMUNI;\n\n        geojsonLayer = {\n          id: \"punts\",\n          data: {\n            type: \"Feature\",\n            geometry: {\n              type: \"MultiPolygon\",\n              coordinates: dades[0].features[0].geometry.coordinates,\n            },\n          },\n          layerType: \"fill\",\n          layout: {},\n          paint: {\n            \"fill-color\": \"red\",\n            \"fill-opacity\": 0.8,\n          },\n        };\n        if (!map.getSource(\"punts-sourceIcgcMap\")) {\n          map.addLayerGeoJSON(geojsonLayer);\n        } else {\n          map.removeLayer(\"punts-layerIcgcMap\");\n          map.removeSource(\"punts-sourceIcgcMap\");\n          map.addLayerGeoJSON(geojsonLayer);\n        }\n      }\n    &lt;/script&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"}]}